{"componentChunkName":"component---src-templates-doc-page-template-js","path":"/guides/bulk_data","result":{"data":{"markdownRemark":{"html":"<p>The FHIR Server has extended operations for Bulk Data <code class=\"language-text\">$import</code>, <code class=\"language-text\">$export</code> and <code class=\"language-text\">$bulkdata-status</code>.</p>\n<h2>Export Operation: $export</h2>\n<p>The <code class=\"language-text\">$export</code> operation uses three OperationDefinition instances:</p>\n<ul>\n<li><a href=\"http://hl7.org/fhir/uv/bulkdata/STU1/OperationDefinition-export.html\">System</a> - Export data from the server.</li>\n<li><a href=\"http://hl7.org/fhir/uv/bulkdata/STU1/OperationDefinition-patient-export.html\">Patient</a> - Obtain a set of resources pertaining to all patients.</li>\n<li><a href=\"http://hl7.org/fhir/uv/bulkdata/STU1/OperationDefinition-group-export.html\">Group</a> - Obtain a set of resources pertaining to patients in a specific Group. Only supports static membership; does not resolve inclusion/exclusion criteria.</li>\n</ul>\n<p>Export file type is ndjson if not specified, however <strong>parquet</strong> format is also supported.</p>\n<h3><strong>$export: Create a Bulk Data Request</strong></h3>\n<p>To create an export request, client application may use GET or POST. When POST is used, the FHIR Server requires the body fields of the request object to be a FHIR Resource <code class=\"language-text\">Parameters</code> JSON Object.</p>\n<h4>Example Request - GET</h4>\n<p>The following is a request to export data from the FHIR Server using GET.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> -k -H <span class=\"token string\">\"Content-Type: application/fhir+json\"</span> <span class=\"token punctuation\">\\</span>\n    -H <span class=\"token string\">'Authorization: &lt;AccessToken>'</span> <span class=\"token punctuation\">\\</span>\n    -X GET <span class=\"token string\">'https://FHIR_BASE/fhir-server/api/v4/$export?_type=Patient'</span> -v</code></pre></div>\n<h4>Example Request - POST</h4>\n<p>The following is a request to export data from the FHIR Server using POST and Parameters resource.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> -k -H <span class=\"token string\">\"Content-Type: application/fhir+json\"</span> <span class=\"token punctuation\">\\</span>\n     -H <span class=\"token string\">'Authorization: &lt;AccessToken>'</span> <span class=\"token punctuation\">\\</span>\n     -X POST <span class=\"token string\">'https://FHIR_BASE/fhir-server/api/v4/$export'</span> <span class=\"token punctuation\">\\</span>\n     -d <span class=\"token string\">'{\n    \"resourceType\": \"Parameters\",\n    \"id\": \"e33a6a4e-29b5-4f62-a3e9-8d09f50ae54d\",\n    \"parameter\": [\n        {\n            \"name\": \"_outputFormat\",\n            \"valueString\": \"application/fhir+ndjson\"\n        },\n        {\n            \"name\": \"_since\",\n            \"valueInstant\": \"2021-01-01T08:21:26.94-04:00\"\n        },\n        {\n            \"name\": \"_type\",\n            \"valueString\": \"Observation,Condition\"\n        }\n    ]\n}'</span></code></pre></div>\n<h2>Status Operation: $bulkdata-status</h2>\n<p>The <code class=\"language-text\">StatusOperation</code> is a BulkData Management endpoint, which uses the <code class=\"language-text\">Content-Location</code>'s http query parameter value for job to manage the Bulk Data job request.</p>\n<p>There are two custom features - <em>Poll Job</em> and <em>Delete Job</em>.</p>\n<h3><strong>$bulkdata-status: Poll Job</strong></h3>\n<p>The response returned is 202 if the job is queued or not yet complete.</p>\n<p>Note: If the job is stopped, e.g, due to shutdown of the FHIR Server where the job is running the bulkdata job, then upon polling the status of the bulkdata job, the server restarts the job, and the response to the client is Accepted: 202.\nThe response returned is 200 if the job is completed.</p>\n<p>The following is a sample path to the exported ndjson file, the full path can be found in the response to the polling location request after the export request (please refer to the FHIR BulkDataAccess specification for details).</p>\n<p><code class=\"language-text\">.../bulkdata/data/6xjd4M8afi6Xo95eYv7zPxBqSCoOEFywZLoqH1QBtbw=/Patient_1.ndjson</code></p>\n<h4>Example</h4>\n<ul>\n<li>Request</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> -k -v  <span class=\"token punctuation\">\\</span>\n    -H <span class=\"token string\">'Authorization: &lt;AccessToken>'</span> <span class=\"token punctuation\">\\</span>\n    <span class=\"token string\">'https://FHIR_BASE/fhir-server/api/v4/$bulkdata-status?job=FvHrLGPv0oKZNyLzBnY5iA%3D%3D'</span></code></pre></div>\n<ul>\n<li>Response for <code class=\"language-text\">$export</code> not yet complete\nThe response code is 202.</li>\n<li>Response for $export upon completion</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"transactionTime\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"2021/07/20 16:53:41.160 -0500\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"request\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/$export?_type=Patient\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"requiresAccessToken\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"output\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"AllergyIntolerance\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"url\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"6SfXzbGvYl1nTjGbf5qeqJDFNjyljiGdKxXEJb4yJn8=/AllergyIntolerance_1.ndjson\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"count\"</span><span class=\"token operator\">:</span> <span class=\"token number\">20</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"AllergyIntolerance\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"url\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"6SfXzbGvYl1nTjGbf5qeqJDFNjyljiGdKxXEJb4yJn8=/AllergyIntolerance_2.ndjson\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"count\"</span><span class=\"token operator\">:</span> <span class=\"token number\">8</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Observation\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"url\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"6SfXzbGvYl1nTjGbf5qeqJDFNjyljiGdKxXEJb4yJn8=/Observation_1.ndjson\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"count\"</span><span class=\"token operator\">:</span> <span class=\"token number\">234</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Observation\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"url\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"6SfXzbGvYl1nTjGbf5qeqJDFNjyljiGdKxXEJb4yJn8=/Observation_2.ndjson\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"count\"</span><span class=\"token operator\">:</span> <span class=\"token number\">81</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3><strong>$bulkdata-status: Delete Job</strong></h3>\n<p>The Bulk Data Request is deleted using the Content-Location and executing the <code class=\"language-text\">DELETE</code> method. The deletion of a job is asynchronous - the job is stopped and subsequently deleted. The data is not cleaned up from the destination storage location - e.g. partially imported data or partially exported data is not cleaned up.</p>\n<ul>\n<li>Request</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> -k -v  -X DELETE <span class=\"token punctuation\">\\</span>\n    -H <span class=\"token string\">'Authorization: &lt;AccessToken>'</span> <span class=\"token punctuation\">\\</span>\n    <span class=\"token string\">'https://FHIR_BASE/fhir-server/api/v4/$bulkdata-status?job=k%2Fd8cTAU%2BUeVEwqURPZ3oA%3D%3D'</span></code></pre></div>\n<ul>\n<li>Response\nThe response returned is 202 if the job deletion is not yet complete.\nThe response returned is 200 if the job deletion is completed.</li>\n</ul>\n<h2>Notes</h2>\n<ol>\n<li>For status codes, if there is an error on the server a 500 is returned, or if there is a client request error, a 400 is returned.</li>\n</ol>","frontmatter":{"date":"March 15, 2021","path":"/guides/bulk_data","title":"07. Bulk Data","sidenav":true}}},"pageContext":{}},"staticQueryHashes":["2236531902","2789967119","63159454"]}